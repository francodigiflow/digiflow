<?xml version="1.0" encoding="utf-8"?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:h="urn:oasis:names:specification:ubl:schema:xsd:Invoice-2" xmlns:cac="urn:oasis:names:specification:ubl:schema:xsd:CommonAggregateComponents-2" xmlns:cbc="urn:oasis:names:specification:ubl:schema:xsd:CommonBasicComponents-2" xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns:ext="urn:oasis:names:specification:ubl:schema:xsd:CommonExtensionComponents-2" xmlns:ns10="urn:sunat:names:specification:ubl:peru:schema:xsd:SummaryDocuments-1" xmlns:ns11="urn:sunat:names:specification:ubl:peru:schema:xsd:VoidedDocuments-1" xmlns:ns6="urn:oasis:names:specification:ubl:schema:xsd:CreditNote-2" xmlns:ns7="urn:oasis:names:specification:ubl:schema:xsd:DebitNote-2" xmlns:qdt="urn:oasis:names:specification:ubl:schema:xsd:QualifiedDatatypes-2" xmlns:sac="urn:sunat:names:specification:ubl:peru:schema:xsd:SunatAggregateComponents-1" exclude-result-prefixes="h"><xsl:import href="libreria.xsl"/>	<xsl:template match='h:Invoice'>		<html>			<head>				<title>Boleta Electronica</title>				<link rel="stylesheet" type="text/css" href="ebxml.css" />			</head>			<body>				<TABLE ALIGN="center" class="form-table" width="1200px" style="margin-left:auto;margin-right:auto;">					<tbody>						<tr>							<td width="30%">								<TABLE>									<TBODY>										<tr>											<td>&#160;</td>										</tr>										<tr>											<td>&#160;</td>										</tr>										<tr>											<td>&#160;</td>										</tr>                                        <tr>											<td>&#160;</td>										</tr>										<tr class="bgn">											<td>												<xsl:value-of select="cac:AccountingSupplierParty/cac:Party/cac:PartyLegalEntity/cbc:RegistrationName" />											</td>										</tr>                                        <xsl:call-template name="evaluarNombreComercial">                                            <xsl:with-param name="nombreComercial" select="cac:AccountingSupplierParty/cac:Party/cac:PartyName/cbc:Name"/>                                        </xsl:call-template>										<tr>											<td>												<xsl:value-of select="cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:StreetName" />												<xsl:value-of select="cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:BuildingNumber" />											</td>										</tr>										<tr>											<td>  												<xsl:if test="cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CountrySubentity='-'">																								</xsl:if>												<xsl:if test="cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CountrySubentity!='-'">													<xsl:call-template name="cdata">	                                                    <xsl:with-param name="param" select="cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CountrySubentity" />	                                                </xsl:call-template>												</xsl:if>    											                                                                                                                                                <xsl:if test="string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CityName)!=0">                                                	<xsl:if test="cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CityName='-'">                                                	</xsl:if>                                                	<xsl:if test="cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CityName!='-'">	                                                	<xsl:if test="string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CountrySubentity)=0">		                                              		<xsl:call-template name="cdata">			                                                    <xsl:with-param name="param" select="cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CityName" />			                                            	</xsl:call-template>		                                              	</xsl:if>		                                              	<xsl:if test="string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CountrySubentity)!=0">		                                              		-		                                              		<xsl:call-template name="cdata">			                                                    <xsl:with-param name="param" select="cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CityName" />			                                            	</xsl:call-template>		                                              	</xsl:if>                                                 	</xsl:if>	                                                                                                                                               </xsl:if>                                         	                                                 	                                            <xsl:if test="string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:District)!=0">	                                            	<xsl:if test="cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:District='-'">	                                            		                                            	</xsl:if>	                                            	<xsl:if test="cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:District!='-'">		                                            	<xsl:if test="string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CountrySubentity)=0 and string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CityName)=0">		                                            		<xsl:call-template name="cdata">				                                            	<xsl:with-param name="param" select="cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:District" />				                                    		</xsl:call-template>		                                            	</xsl:if>		                                            	<xsl:if test="string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CountrySubentity)!=0 and string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CityName)!=0">		                                            		-		                                            		<xsl:call-template name="cdata">				                                            	<xsl:with-param name="param" select="cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:District" />				                                    		</xsl:call-template>		                                            	</xsl:if>		                                            	<xsl:if test="string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CountrySubentity)=0 and string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CityName)!=0">		                                            		-		                                            		<xsl:call-template name="cdata">				                                            	<xsl:with-param name="param" select="cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:District" />				                                    		</xsl:call-template>		                                            	</xsl:if>		                                            	<xsl:if test="string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CountrySubentity)!=0 and string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CityName)=0">		                                            		-		                                            		<xsl:call-template name="cdata">				                                            	<xsl:with-param name="param" select="cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:District" />				                                    		</xsl:call-template>		                                            	</xsl:if>	                                            		                                            	</xsl:if>	                                            		                                            		                                            		                                            </xsl:if>  											 												 												 											 												 	<xsl:if test="string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CitySubdivisionName)!=0">											 		<xsl:if test="cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CitySubdivisionName='-'">											 													 		</xsl:if>											 		<xsl:if test="cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CitySubdivisionName!='-'">											 														 		<xsl:if test="string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CountrySubentity)=0 and string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CityName)=0 and string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:District)=0">											 															 			<xsl:call-template name="cdata">				                                           		 <xsl:with-param name="param" select="cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CitySubdivisionName" />				                                    		</xsl:call-template>												 		</xsl:if>												 		<xsl:if test="string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CountrySubentity)=0 and string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CityName)=0 and string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:District)!=0">												 			-												 			<xsl:call-template name="cdata">				                                           		 <xsl:with-param name="param" select="cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CitySubdivisionName" />				                                    		</xsl:call-template>												 		</xsl:if>												 		<xsl:if test="string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CountrySubentity)=0 and string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CityName)!=0 and string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:District)=0">												 			-												 			<xsl:call-template name="cdata">				                                           		 <xsl:with-param name="param" select="cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CitySubdivisionName" />				                                    		</xsl:call-template>												 		</xsl:if>												 		<xsl:if test="string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CountrySubentity)=0 and string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CityName)!=0 and string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:District)!=0">												 			-												 			<xsl:call-template name="cdata">				                                           		 <xsl:with-param name="param" select="cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CitySubdivisionName" />				                                    		</xsl:call-template>												 		</xsl:if>												 		<xsl:if test="string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CountrySubentity)!=0 and string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CityName)=0 and string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:District)=0">												 			-												 			<xsl:call-template name="cdata">				                                           		 <xsl:with-param name="param" select="cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CitySubdivisionName" />				                                    		</xsl:call-template>												 		</xsl:if>												 		<xsl:if test="string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CountrySubentity)!=0 and string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CityName)=0 and string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:District)!=0">												 			-												 			<xsl:call-template name="cdata">				                                           		 <xsl:with-param name="param" select="cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CitySubdivisionName" />				                                    		</xsl:call-template>												 		</xsl:if>												 		<xsl:if test="string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CountrySubentity)!=0 and string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CityName)!=0 and string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:District)=0">												 			-												 			<xsl:call-template name="cdata">				                                           		 <xsl:with-param name="param" select="cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CitySubdivisionName" />				                                    		</xsl:call-template>												 		</xsl:if>												 		<xsl:if test="string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CountrySubentity)!=0 and string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CityName)!=0 and string-length(cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:District)!=0">												 			-												 			<xsl:call-template name="cdata">				                                           		 <xsl:with-param name="param" select="cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CitySubdivisionName" />				                                    		</xsl:call-template>												 		</xsl:if>											 		</xsl:if>											 													 	</xsl:if>  											</td>										</tr>									</TBODY>								</TABLE>							</td>							<td width="30%">								<TABLE align="right" class="form-table-cabecera">									<TBODY>										<tr>											<td class="T2">												R.U.C.												<xsl:value-of select="cac:AccountingSupplierParty/cbc:CustomerAssignedAccountID" />											</td>										</tr>										<tr>											<td class="T2">BOLETA</td>										</tr>										<tr>											<td class="T2">ELECTRÓNICA</td>										</tr>										<tr>											<td class="T2">												<xsl:value-of select="cbc:ID" />											</td>										</tr>									</TBODY>								</TABLE>							</td>						</tr>						<tr>							<td colspan="2">								<table width="100%">									<tbody>										<tr>											<td width="100%">												<TABLE>													<TBODY>														<TR>															<TD class="bgn" width="15%" align="left">Nombre/Razón Social:</TD>															<TD align="left" width="30%">																<xsl:value-of select="cac:AccountingCustomerParty/cac:Party/cac:PartyLegalEntity/cbc:RegistrationName" />															</TD>															<TD class="bgn" width="10%" align="left">																<xsl:call-template name="tipoDocumentoCabecera">																	<xsl:with-param name="tipoDocumento" select="cac:AccountingCustomerParty/cbc:AdditionalAccountID" />																</xsl:call-template>															</TD>															<TD align="left" width="15%">																<xsl:value-of																	select="cac:AccountingCustomerParty/cbc:CustomerAssignedAccountID" />															</TD>                                                            <TD class="bgn" width="10%" align="left">Fecha Emisión:</TD>															<TD align="left" width="15%">                                                                <xsl:call-template name="formatoFecha">																	<xsl:with-param name="fecha" select="cbc:IssueDate" />																</xsl:call-template>															</TD>														</TR>														<TR>															<td class="bgn" width="15%" align="left">Dirección:</td>                                                            <xsl:call-template name="evaluarDireccion">																	<xsl:with-param name="direccionExplicita" select="cac:AccountingCustomerParty/cac:Party/cac:PhysicalLocation/cbc:Description" />																	<xsl:with-param name="camposAdicionales" select="ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/cbc:AdditionalInformation/sac:AdditionalProperty" />                                                            </xsl:call-template>                                                            <td class="bgn" width="10%" align="left">Moneda:</td>															<td align="left" width="15%">                                                                <xsl:value-of select="concat(cbc:DocumentCurrencyCode, ' - ')" />																<xsl:call-template name="moneyCabeceraLargo">																	<xsl:with-param name="tipoMoneda" select="cbc:DocumentCurrencyCode" />																</xsl:call-template>															</td>															<TD class="bgn" width="10%" align="left">Orden de Compra:</TD>															<TD align="left" width="25%">                                                                <xsl:for-each select="ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/cbc:AdditionalInformation/sac:AdditionalProperty">                                                                <xsl:choose>                                                                    <xsl:when test="cbc:Id = 9043 or cbc:ID = 9043">                                                                        <xsl:call-template name="cdata">                                                                            <xsl:with-param name="param" select="cbc:Value" />                                                                        </xsl:call-template>                                                                    </xsl:when>																	</xsl:choose>																</xsl:for-each>															</TD>														</TR>                                                        <xsl:call-template name="buscarGuiasRemisionDocumentosReferenciadosFechaDocumentoOriginal">                                                            <xsl:with-param name="listaDocumentosReferenciados" select="cac:AdditionalDocumentReference" />                                                            <xsl:with-param name="listaInformacionAdicional" select="ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/cbc:AdditionalInformation/sac:AdditionalProperty" />                                                            <xsl:with-param name="tipoDocumento" select="string('B')" />                                                        </xsl:call-template>                                                        <xsl:for-each select="ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/cbc:AdditionalInformation/sac:AdditionalProperty">                                                           <xsl:choose>                                                                <xsl:when test="cbc:Id = 9502 or cbc:ID = 9502">                                                                    <TR>                                                                        <TD class="bgn" width="17%" align="left">Producto Descripción:</TD>                                                                        <td align="left">                                                                            <xsl:call-template name="cdata">                                                                                <xsl:with-param name="param" select="cbc:Value" />                                                                            </xsl:call-template>                                                                        </td>                                                                    </TR>                                                                </xsl:when>                                                           </xsl:choose>                                                        </xsl:for-each>													</TBODY>												</TABLE>											</td>										</tr>									</tbody>								</table>							</td>						</tr>						<tr>							<td colspan="2">								<TABLE width="100%" cellspacing="0" cellpadding="0" border="0" rules="all">									<TBODY>										<tr class="beta" align="center">											<td width="3%" style="border: #4682b4 1px solid;">Ítem</td>											<td width="3%" style="border: #4682b4 1px solid;">Código</td>											<td width="44%" style="border: #4682b4 1px solid;">Descripción</td>                                            <td width="3%" style="border: #4682b4 1px solid;">Und.</td>                                            <td width="10%" style="border: #4682b4 1px solid;">Cantidad</td>                                            <td width="10%" style="border: #4682b4 1px solid;">V. Unitario</td>											<td width="10%" style="border: #4682b4 1px solid;">P. Unitario</td>                                            <td width="10%" style="border: #4682b4 1px solid;">Descuento</td>                                            <td width="10%" style="border: #4682b4 1px solid;">Valor Total</td>										</tr>										<xsl:for-each select="cac:InvoiceLine">											<tr>                                                <td align="center" width="5%" style="border-right: #4682b4 1px solid; border-top:#4682b4 1px solid; border-left: #4682b4 1px solid; border-bottom: #4682b4 1px solid; padding:5px 5px 5px 5px;">													<xsl:value-of select="cbc:ID" />												</td>												<td align="center" width="5%" style="border-right: #4682b4 1px solid; border-top:#4682b4 1px solid; border-left: #4682b4 1px solid; border-bottom: #4682b4 1px solid; padding:5px 5px 5px 5px;">													<xsl:value-of select="cac:Item/cac:SellersItemIdentification/cbc:ID" />												</td>												<td width="5%" style="border-right: #4682b4 1px solid; border-top:#4682b4 1px solid; border-left: #4682b4 1px solid; border-bottom: #4682b4 1px solid; padding:5px 5px 5px 5px;">													<xsl:for-each select="cac:Item/cbc:Description">                                                        <xsl:call-template name="cdata">                                                            <xsl:with-param name="param" select="." />                                                        </xsl:call-template>													</xsl:for-each>													<xsl:for-each select="cac:Item/cac:AdditionalItemProperty">                                                        <xsl:sort select="cbc:Name" order="descending"/>                                                            <xsl:choose>                                                                <xsl:when test="cbc:Name!=9005">                                                                    <br/>                                                                    <xsl:call-template name="campoAdicionalItem">                                                                        <xsl:with-param name="codigoCampoAdicional" select="cbc:Name" />                                                                    </xsl:call-template>                                                                    <xsl:call-template name="cdata">                                                                        <xsl:with-param name="param" select="cbc:Value" />                                                                    </xsl:call-template>                                                                </xsl:when>                                                            </xsl:choose>													</xsl:for-each><!--                                                     <xsl:call-template name="evaluarUnidadMedidaSunat"> --><!--                                                         <xsl:with-param name="camposAdicionales" select="cac:Item/cac:AdditionalItemProperty" /> --><!--                                                         <xsl:with-param name="unidadMedidaItem" select="cbc:InvoicedQuantity/@unitCode" /> --><!--                                                     </xsl:call-template> -->												</td>                                                <td align="center" width="5%" style="border-right: #4682b4 1px solid; border-top:#4682b4 1px solid; border-left: #4682b4 1px solid; border-bottom: #4682b4 1px solid; padding:5px 5px 5px 5px;">                                                    <xsl:call-template name="evaluarUnidadMedida">                                                        <xsl:with-param name="camposAdicionales" select="cac:Item/cac:AdditionalItemProperty" />                                                        <xsl:with-param name="unidadMedidaItem" select="cbc:InvoicedQuantity/@unitCode" />                                                    </xsl:call-template>												</td>                                                <td align="right" width="10%" style="border-right: #4682b4 1px solid; border-top:#4682b4 1px solid; border-left: #4682b4 1px solid; border-bottom: #4682b4 1px solid; padding:5px 5px 5px 5px;">                                                    <xsl:call-template name="formatNumberTresDecimales">															<xsl:with-param name="numero" select="cbc:InvoicedQuantity" />                                                    </xsl:call-template>												</td>												<td align="right" width="10%" style="border-right: #4682b4 1px solid; border-top:#4682b4 1px solid; border-left: #4682b4 1px solid; border-bottom: #4682b4 1px solid; padding:5px 5px 5px 5px;">                                                    <xsl:call-template name="formatNumberTresDecimales">                                                        <xsl:with-param name="numero" select="cac:Price/cbc:PriceAmount" />                                                    </xsl:call-template>												</td>												<td align="right" width="10%" style="border-right: #4682b4 1px solid; border-top:#4682b4 1px solid; border-left: #4682b4 1px solid; border-bottom: #4682b4 1px solid; padding:5px 5px 5px 5px;">                                                    <xsl:call-template name="formatNumberTresDecimales">														<xsl:with-param name="numero" select="cac:PricingReference/cac:AlternativeConditionPrice/cbc:PriceAmount" />                                                    </xsl:call-template>												</td>												<td align="right" width="10%" style="border-right: #4682b4 1px solid; border-top:#4682b4 1px solid; border-left: #4682b4 1px solid; border-bottom: #4682b4 1px solid; padding:5px 5px 5px 5px;">                                                    <xsl:call-template name="formatDescuento">															<xsl:with-param name="numero" select="cac:AllowanceCharge[cbc:ChargeIndicator='false']/cbc:Amount" />                                                    </xsl:call-template>												</td>                                                <td align="right" width="10%" style="border-right: #4682b4 1px solid; border-top:#4682b4 1px solid; border-left: #4682b4 1px solid; border-bottom: #4682b4 1px solid; padding:5px 0px 0px 5px;">                                                    <xsl:value-of select='format-number(cbc:LineExtensionAmount, "###,##0.00")' />												</td>											</tr>										</xsl:for-each>									</TBODY>								</TABLE>							</td>						</tr>						<tr>							<td colspan="2" valign="top">								<table width="100%" valign="top">									<tr>										<td valign="top" align="left" width="70%">                                           <table valign="top">												<xsl:for-each select="ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/sac:AdditionalInformation/sac:AdditionalProperty">												   <xsl:choose>												   <xsl:when test="cbc:Id = 1000 or cbc:ID = 1000">                                                         <tr valign="top">                                                             <td valign="top" style="left" >                                                                 <xsl:call-template name="cdata">                                                                    <xsl:with-param name="param" select="cbc:Value" />                                                                 </xsl:call-template>                                                             </td>                                                         </tr>													 </xsl:when>													</xsl:choose>												</xsl:for-each>                                            </table>										</td>										<td>											<TABLE class="form-table" width="370px;" align="right">												<TBODY>													<xsl:for-each select="cac:LegalMonetaryTotal">														<xsl:choose>                                                            <xsl:when test=" cbc:AllowanceTotalAmount > 0 ">                                                                <tr align="right">                                                                    <td class="gamma" align="left">Descuentos Globales</td>                                                                    <td align="right">                                                                        <xsl:call-template name="moneyCabeceraCorto">                                                                            <xsl:with-param name="tipoMoneda" select="cbc:AllowanceTotalAmount/@currencyID" />                                                                        </xsl:call-template>                                                                    </td>                                                                    <td align="right">																		<xsl:value-of select='format-number(cbc:AllowanceTotalAmount, "###,##0.00")' />                                                                    </td>                                                                </tr>                                                                <br/>                                                            </xsl:when>														</xsl:choose>													</xsl:for-each>                                                    <xsl:for-each select="ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/cbc:AdditionalInformation/sac:AdditionalProperty">                                                       <xsl:choose>                                                            <xsl:when test=" (cbc:Id = 9504 or cbc:ID = 9504) ">                                                                <tr align="right">																	<td class="gamma" width="60%" align="left">TOTAL PAGOS</td>																	<td align="right" width="10%">																		<xsl:call-template name="moneyCabeceraCorto">																			<xsl:with-param name="tipoMoneda" select="../../../../../cbc:DocumentCurrencyCode" />																		</xsl:call-template>																		</td>																	<td align="right" width="25%">                                                                        <xsl:call-template name="validarSiEsNumeroCeroDefecto">                                                                                <xsl:with-param name="valorTag" select="sum(cbc:Value)" />                                                                        </xsl:call-template>																	</td>                                                                </tr>                                                            </xsl:when>                                                       </xsl:choose>                                                    </xsl:for-each>	                                                    <xsl:for-each select="ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/cbc:AdditionalInformation/sac:AdditionalProperty">                                                       <xsl:choose>                                                            <xsl:when test=" (cbc:Id = 9503 or cbc:ID = 9503) ">                                                                <tr  align="right">																	<td class="gamma" width="60%" align="left">TOTAL DEDUCCIONES</td>																	<td align="right" width="10%">																	    <xsl:call-template name="moneyCabeceraCorto">																			<xsl:with-param name="tipoMoneda" select="../../../../../cbc:DocumentCurrencyCode" />																		</xsl:call-template>																	</td>																	<td align="right" width="25%">                                                                        <xsl:call-template name="validarSiEsNumeroCeroDefecto">                                                                                <xsl:with-param name="valorTag" select="sum(cbc:Value)" />                                                                        </xsl:call-template>																	</td>                                                                </tr>                                                            </xsl:when>                                                       </xsl:choose>                                                    </xsl:for-each>													<xsl:call-template name="evaluarDocumentoAnterior">                                                        <xsl:with-param name="listaAdditionalInformation" select="ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/cbc:AdditionalInformation/sac:AdditionalProperty"/>                                                        <xsl:with-param name="tipoMoneda" select="cbc:DocumentCurrencyCode" />													</xsl:call-template>                                                    <xsl:for-each select="ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/sac:AdditionalInformation/sac:AdditionalMonetaryTotal">                                                        <xsl:choose>                                                            <xsl:when test="cbc:Id =1001 or cbc:ID =1001">                                                                <tr  align="right">                                                                    <td class="gamma" width="60%" align="left">Op. Gravada</td>                                                                    <td align="right">                                                                        <xsl:value-of select="cbc:PayableAmount/@currencyID" />                                                                    </td>                                                                    <td align="right" width="25%">																		<xsl:value-of select='format-number(cbc:PayableAmount, "###,##0.00")' />                                                                    </td>                                                                </tr>                                                            </xsl:when>                                                        </xsl:choose>                                                    </xsl:for-each>													<xsl:for-each select="cac:TaxTotal/cac:TaxSubtotal">														<xsl:choose>                                                            <xsl:when test="cbc:TaxAmount >= 0 and cac:TaxCategory/cac:TaxScheme/cbc:Name='IGV'">                                                                <xsl:call-template name="evaluarMostrarIGV">                                                                    <xsl:with-param name="igv" select="cac:TaxCategory/cac:TaxScheme/cbc:Name" />                                                                    <xsl:with-param name="moneda" select="cbc:TaxAmount/@currencyID" />                                                                    <xsl:with-param name="monto" select="cbc:TaxAmount" />                                                                    <xsl:with-param name="additionals" select="../../ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/cbc:AdditionalInformation/sac:AdditionalProperty" />                                                                </xsl:call-template>                                                            </xsl:when>                                                            <xsl:when test="cbc:TaxAmount > 0 and cac:TaxCategory/cac:TaxScheme/cbc:Name='OTROS'">                                                                <tr align="right">                                                                    <td class="gamma" align="left">OTROS TRIBUTOS</td>                                                                    <td align="right">                                                                    <xsl:call-template name="moneyCabeceraCorto">                                                                        <xsl:with-param name="tipoMoneda" select="cbc:DocumentCurrencyCode" />                                                                    </xsl:call-template>                                                                    </td>                                                                    <td align="right"  width="25%">                                                                    <xsl:value-of select='format-number(cbc:TaxAmount, "###,##0.00")' />                                                                    </td>                                                                </tr>														    </xsl:when>                                                            <xsl:when test="cbc:TaxAmount > 0 and cac:TaxCategory/cac:TaxScheme/cbc:Name='ISC'">                                                                <tr align="right">                                                                    <td class="gamma" align="left">                                                                        <xsl:value-of select="cac:TaxCategory/cac:TaxScheme/cbc:Name" />                                                                    </td>                                                                    <td align="right">                                                                        <xsl:call-template name="moneyCabeceraCorto">                                                                            <xsl:with-param name="tipoMoneda" select="../../cbc:DocumentCurrencyCode" />                                                                        </xsl:call-template>                                                                    </td>                                                                    <td align="right" width="25%">                                                                        <xsl:value-of select='format-number(cbc:TaxAmount, "###,##0.00")' />                                                                    </td>                                                                </tr>														    </xsl:when>														</xsl:choose>													</xsl:for-each>                                                    <xsl:for-each select="ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/sac:AdditionalInformation/sac:AdditionalMonetaryTotal">                                                        <xsl:choose>                                                            <xsl:when test="(cbc:Id =1002 or cbc:ID =1002) and (cbc:Value>0) ">                                                                <tr align="right">                                                                    <td class="gamma" width="60%" align="left">Op. Inafecta</td>                                                                    <td align="right">																		<xsl:call-template name="moneyCabeceraCorto">																			<xsl:with-param name="tipoMoneda" select="cbc:DocumentCurrencyCode" />																		</xsl:call-template>                                                                    </td>                                                                    <td align="right" width="25%">																		<xsl:value-of select='format-number(cbc:PayableAmount, "###,##0.00")' />                                                                    </td>                                                                </tr>                                                            </xsl:when>                                                        </xsl:choose>                                                    </xsl:for-each>                                                    <xsl:for-each select="ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/sac:AdditionalInformation/sac:AdditionalMonetaryTotal">                                                        <xsl:choose>                                                            <xsl:when test="(cbc:Id =1003 or cbc:ID =1003) and (cbc:PayableAmount>0) ">                                                                <tr align="right">                                                                    <td class="gamma" width="60%" align="left">Op. Exonerada</td>                                                                    <td align="right">																		<xsl:call-template name="moneyCabeceraCorto">																			<xsl:with-param name="tipoMoneda" select="cbc:DocumentCurrencyCode" />																		</xsl:call-template>                                                                    </td>                                                                    <td align="right" width="25%">																		<xsl:value-of select='format-number(cbc:PayableAmount, "###,##0.00")' />                                                                    </td>                                                                </tr>                                                            </xsl:when>                                                        </xsl:choose>                                                    </xsl:for-each>                                                    <xsl:for-each select="ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/sac:AdditionalInformation/sac:AdditionalMonetaryTotal">                                                        <xsl:choose>                                                            <xsl:when test="(cbc:Id =1004 or cbc:ID =1004) and (cbc:PayableAmount>0) ">                                                                <tr align="right">                                                                    <td class="gamma" width="60%" align="left">Op. Gratuita</td>                                                                    <td align="right">																		<xsl:value-of select="cbc:PayableAmount/@currencyID" />                                                                    </td>                                                                    <td align="right" width="25%">																		<xsl:value-of select='format-number(cbc:PayableAmount, "###,##0.00")' />                                                                    </td>                                                                </tr>                                                            </xsl:when>                                                        </xsl:choose>                                                    </xsl:for-each>                                                    <!--OTROS CARGOS - PORCENTAJE SERVICIO-->                                                    <xsl:choose>                                                        <xsl:when test="cac:LegalMonetaryTotal/cbc:ChargeTotalAmount > 0 ">                                                            <tr align="right">                                                                <td class="gamma" align="left" width="60%">                                                                    <xsl:call-template name="evaluarPorcentajeServicio">                                                                        <xsl:with-param name="datos" select="ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/cbc:AdditionalInformation/sac:AdditionalProperty" />                                                                    </xsl:call-template>                                                                    <xsl:for-each select="ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/cbc:AdditionalInformation/sac:AdditionalProperty">                                                                       <xsl:choose>                                                                            <xsl:when test="cbc:Id = 9500 or cbc:ID = 9500">                                                                                <br/><b><i>(<xsl:value-of select="cbc:Value"/>)</i></b>                                                                            </xsl:when>                                                                       </xsl:choose>                                                                    </xsl:for-each>                                                                </td>                                                                <td align="right">                                                                    <xsl:call-template name="moneyCabeceraCorto">                                                                        <xsl:with-param name="tipoMoneda" select="cac:LegalMonetaryTotal/cbc:ChargeTotalAmount/@currencyID" />                                                                    </xsl:call-template>                                                                </td>                                                                <td align="right" width="25%">                                                                    <xsl:call-template name="validarSiEsNumeroCeroDefecto">                                                                            <xsl:with-param name="valorTag" select="cac:LegalMonetaryTotal/cbc:ChargeTotalAmount" />                                                                    </xsl:call-template>                                                                </td>                                                            </tr>                                                        </xsl:when>                                                    </xsl:choose>													<tr align="right">														<td class="gamma" align="left">IMPORTE TOTAL															<xsl:for-each select="ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/cbc:AdditionalInformation/sac:AdditionalProperty">															   <xsl:choose>																	<xsl:when test="cbc:Id = 9501 or cbc:ID = 9501">																		<br/><b><i>                                                                            (<xsl:call-template name="cdata">                                                                                <xsl:with-param name="param" select="cbc:Value" />                                                                            </xsl:call-template>)                                                                        </i></b>																	</xsl:when>															   </xsl:choose>															</xsl:for-each>																																																							</td>														<td align="right">															<xsl:call-template name="moneyCabeceraCorto">																<xsl:with-param name="tipoMoneda" select="cbc:DocumentCurrencyCode" />															</xsl:call-template>														</td>														<td align="right">                                                            <xsl:value-of select='format-number(cac:LegalMonetaryTotal/cbc:PayableAmount, "###,##0.00")' />														</td>													</tr>                                                    <xsl:for-each select="ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/sac:AdditionalInformation/sac:AdditionalMonetaryTotal">                                                        <xsl:choose>                                                            <xsl:when test="(cbc:Id =2005 or cbc:ID =2005) and (cbc:PayableAmount>0) ">                                                                <br/>                                                                <tr align="right">                                                                    <td class="gamma" align="left">Total Descuento</td>                                                                    <td align="right">                                                                        <xsl:call-template name="moneyCabeceraCorto">                                                                            <xsl:with-param name="tipoMoneda" select="cbc:PayableAmount/@currencyID" />                                                                        </xsl:call-template>                                                                    </td>                                                                    <td align="right">																		<xsl:value-of select='format-number(cbc:PayableAmount, "###,##0.00")' />                                                                    </td>                                                                </tr>                                                            </xsl:when>                                                        </xsl:choose>                                                    </xsl:for-each>												</TBODY>											</TABLE>										</td>									</tr>								</table>							</td>						</tr>												<tr>						  <td colspan="2">							<xsl:for-each select="ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/sac:AdditionalInformation/sac:AdditionalMonetaryTotal">							    <xsl:choose>                                     <xsl:when test="cbc:Id = 2001 or cbc:ID = 2001">                                        <xsl:call-template name="evaluarPercepcion">                                            <xsl:with-param name="porcentagePercepcion" select="cbc:Percent" />                                            <xsl:with-param name="montoPercepcion" select="cbc:PayableAmount" />                                            <xsl:with-param name="baseImponible" select="sac:ReferenceAmount" />                                            <xsl:with-param name="totalFactura" select="sac:TotalAmount" />                                        </xsl:call-template>                                     </xsl:when>                                     <xsl:when test="cbc:Id = 2003 or cbc:ID = 2003">                                        <xsl:call-template name="evaluarDetraccion">                                            <xsl:with-param name="porcentageDetraccion" select="cbc:Percent" />                                            <xsl:with-param name="montoDetraccion" select="cbc:PayableAmount" />                                            <xsl:with-param name="montoDetraccionReferencial" select="sac:ReferenceAmount" />                                            <xsl:with-param name="name" select="cbc:Name" />                                        </xsl:call-template>                                     </xsl:when>								</xsl:choose>							</xsl:for-each>							</td>						</tr>						                        <xsl:if test="count(ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/cbc:AdditionalInformation/sac:AdditionalProperty[                            (cbc:Id != 9500 or cbc:ID != 9500) and (cbc:Id != 9501 or cbc:ID != 9501) and (cbc:Id != 9502 or cbc:ID != 9502) and (cbc:Id != 9503 or cbc:ID != 9503)                            and (cbc:Id != 9504 or cbc:ID != 9504) and (cbc:Id != 9505 or cbc:ID != 9505) and (cbc:Id != 9506 or cbc:ID != 9506)                            and (cbc:Id != 9003 or cbc:ID != 9003) and (cbc:Id != 9043 or cbc:ID != 9043) and (cbc:Id != 9011 or cbc:ID != 9011)]) > 0 ">                            <tr>                                <td colspan="2">                                    <table width="69%">                                        <tr>                                            <td colspan="2">                                                <table width="100%">                                                    <tr>                                                        <TD class="bgn" align="left" colspan="5">Información Adicional</TD>                                                    </tr>                                                </table>                                            </td>                                        </tr>                                        <tr>                                            <td colspan="2">                                                <table width="100%" cellspacing="0" cellpadding="0" border="0" rules="all">                                                    <xsl:for-each                                                            select="ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/cbc:AdditionalInformation/sac:AdditionalProperty[(cbc:Id != 9500 or cbc:ID != 9500) and (cbc:Id != 9501 or cbc:ID != 9501) and (cbc:Id != 9502 or cbc:ID != 9502) and (cbc:Id != 9503 or cbc:ID != 9503) and (cbc:Id != 9504 or cbc:ID != 9504) and (cbc:Id != 9505 or cbc:ID != 9505) and (cbc:Id != 9506 or cbc:ID != 9506) and (cbc:Id != 9003 or cbc:ID != 9003) and (cbc:Id != 9043 or cbc:ID != 9043) and (cbc:Id != 9011 or cbc:ID != 9011)]">                                                        <xsl:sort select="cbc:ID" order="descending"/>                                                        <tr style="border-color: #4682b4;">                                                            <td width="3%" align="left"                                                                style="border-right: #4682b4 1px solid; border-top:#4682b4 1px solid; border-left: #4682b4 1px solid; border-bottom: #4682b4 1px solid">                                                                <xsl:value-of select="position()"/>                                                            </td>                                                            <td class="bgn" width="40%" align="left"                                                                style="border-right: #4682b4 1px solid; border-top:#4682b4 1px solid; border-left: #4682b4 1px solid; border-bottom: #4682b4 1px solid">                                                                <xsl:call-template name="campoAdicionalCabecera">                                                                    <xsl:with-param name="codigoCampoAdicional"                                                                                    select="cbc:ID"/>                                                                </xsl:call-template>                                                            </td>                                                            <td width="57%" align="left"                                                                style="border-right: #4682b4 1px solid; border-top:#4682b4 1px solid; border-left: #4682b4 1px solid; border-bottom: #4682b4 1px solid">                                                                <xsl:call-template name="cdata">                                                                    <xsl:with-param name="param" select="cbc:Value"/>                                                                </xsl:call-template>                                                                <xsl:if test="string-length(cbc:Name)>0">                                                                    <br/>                                                                    <xsl:call-template name="cdata">                                                                        <xsl:with-param name="param" select="cbc:Name"/>                                                                    </xsl:call-template>                                                                </xsl:if>                                                            </td>                                                        </tr>                                                    </xsl:for-each>                                                </table>                                            </td>                                        </tr>                                    </table>                                </td>                            </tr>                        </xsl:if>                        <xsl:if test="count(ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/sac:AdditionalInformation/sac:AdditionalProperty[                         cbc:ID=1002 or cbc:ID=2000 or cbc:ID=2001 or cbc:ID=2002 or cbc:ID=2003 or cbc:ID=2004 ])>0">                            <xsl:call-template name="evaluarLeyendas">                                <xsl:with-param name="listaLeyendas"                                    select="ext:UBLExtensions/ext:UBLExtension/ext:ExtensionContent/sac:AdditionalInformation/sac:AdditionalProperty[cbc:ID=1002 or cbc:ID=2000 or cbc:ID=2001 or cbc:ID=2002 or cbc:ID=2003 or cbc:ID=2004                                        or cbc:ID=3000 or cbc:ID=3001 or cbc:ID=3002 or cbc:ID=3003 or cbc:ID=3004 or cbc:ID=3005 or cbc:ID=3006 or cbc:ID=3007 or cbc:ID=3008 or cbc:ID=3009 or cbc:ID=3010                                        or cbc:ID=4000 or cbc:ID=4001 or cbc:ID=4002 or cbc:ID=4003 or cbc:ID=4004 or cbc:ID=4005 or cbc:ID=4006 or cbc:ID=4007 or cbc:ID=4008 or cbc:ID=4009 ]"/>                            </xsl:call-template>                        </xsl:if>						<tr><td colspan="2" align="center" ></td></tr>						<tr><td colspan="2" align="left" >Representación Impresa de la Boleta Electrónica, consulte en https://sfe.bizlinks.com.pe</td></tr>						<tr><td colspan="2" align="center" ></td></tr>					</tbody>				</TABLE>			</body>		</html>	</xsl:template></xsl:stylesheet>